<?lua
require "teamf1lualib/snmp_bl"
require "teamf1lualib/errorMap"
require "teamf1lualib/returnCodes"

local snmp = require("com.teamf1.bl.snmp.users")
local errorMap    = require ("com.teamf1.core.errorMap")
local returnCodes = require ("com.teamf1.core.returnCodes")

if(ButtonType  and ButtonType == "edit") then
    local returnCode, cookie,  userName, privilege, securityLevel 
    local authAlgorithm, authPassword, privacyAlgorithm, privacyPassword
    configRowId = cgi["configRowId"]
    returnCode, cookie, userName, privilege, securityLevel, 
       authAlgorithm, authPassword, privacyAlgorithm, privacyPassword = 
        snmp.snmpUserSectionGetCur(configRowId)
    if (returnCode == returnCodes.SUCCESS) then
        statusSuccessMessage = errorMap.errorStringGet (returnCode)
    else 
        statusErrorMessage = errorMap.errorStringGet (returnCode)
    end
    cgilua.header ("Content-Type", "text/html; charset=UTF-8")
?>
<div id="tf1_snmpDailogContent">
                <div class="topBg">
                    <h1 data-localize="12884">SNMP User</h1>
                    <close>
                        <a href="#" id="btnClose" title="Close">X</a>
                    </close>
                </div>
                <div class="dialogMidArea">
                    <div class="configRow">
                        <label data-localize="13242"> Username </label>
                        <p>
                            $| userName |$
                        </p>
                    </div>
                    <div class="break" id="break1_div">
                        &nbsp;
                    </div>
                    <div class="configRow">
                        <label data-localize="10042"> Access Privilege </label>
                        <p>
                            $| privilege |$
                        </p>
                    </div>
                    <div class="break" id="break2_div">
                        &nbsp;
                    </div>
                    <div class="configRow">
                        <label data-localize="12793"> Security Level </label>
                        <select name="snmp.securityLevel" size="1" id="tf1_securityLevel" onchange="checkSecurityLevel('tf1_securityLevel')">
                            <option data-localize="14107" $| web.dropdownSelected(securityLevel == "1" ) |$ value="1">No-Auth No-Priv</option>
                            <option data-localize="14108" $| web.dropdownSelected(securityLevel == "2" ) |$ value="2">Auth No-Priv</option>
                            <option data-localize="14109" $| web.dropdownSelected(securityLevel == "3" ) |$ value="3">AuthPriv</option>
                        </select>
                    </div>
                    <div class="break" id="break3_div">
                        &nbsp;
                    </div>
                    <div class="configRow" id="tf1_authAlogorithm_div">
                        <label data-localize="10313"> Authentication Algorithm </label>
                        <p>
                            <input type="radio" name="snmp.authAlgo" $| web.radioSelected(authAlgorithm == "1" ) |$ value="1">
                            <span data-localize="11701">MD5</span>
                        </p>
                        <p>
                            <input type="radio" name="snmp.authAlgo" $|
                            web.radioSelected(authAlgorithm == "2" ) |$ value="2">
                            <span data-localize="14106">SHA1</span>
                        </p>
                    </div>
                    <div class="break" id="break4_div">
                        &nbsp;
                    </div>
                    <div class="configRow" id="tf1_txtAuthPass_div">
                        <label data-localize="10322"> Authentication Password </label>
                        <input maxlength="20" name="snmp.authPassword" value="$|
                        authPassword or '' |$" id="tf1_txtAuthPass" onkeypress="if (event.keyCode != 9) { this.value = ''; this.onkeypress=''; }" type="password">
                    </div>
                    <div class="break" id="break5_div">
                        &nbsp;
                    </div>
                    <div class="configRow" id="tf1_privacyAlogorithm_div">
                        <label data-localize="12547"> Privacy Algorithm </label>
                        <p>
                            <input type="radio" name="snmp.privAlgo" $| web.radioSelected(privacyAlgorithm == "1" ) |$ value="1">
                            <span data-localize="10701">DES</span>
                        </p>
                        <p>
                            <input type="radio" name="snmp.privAlgo" $|
                            web.radioSelected(privacyAlgorithm == "2" ) |$ value="2">
                            <span data-localize="10197">AES</span>
                        </p>
                    </div>
                    <div class="break" id="break6_div">
                        &nbsp;
                    </div>
                    <div class="configRow" id="tf1_txtPrivPass_div">
                        <label data-localize="12548"> Privacy Password </label>
                        <input maxlength="16" name="snmp.privPassword" value="$| privacyPassword or '' |$" id="tf1_txtPrivPass" onkeypress="if (event.keyCode != 9) { this.value = ''; this.onkeypress=''; }" type="password">
                    </div>
                    <div class="break">
                        &nbsp;
                    </div>
                </div>
                <div class="dialogSubmitRow">
                    <input data-localize="12758" type="submit" name="button.config.snmp.snmp.$|
                    configRowId |$" onclick="return pageValidate()" class="btnSubmit" title="Save" value="Save" id="btSave">
                </div>
            </div>
<?lua end?>

<?lua
require "teamf1lualib/optionMode_bl"
require "teamf1lualib/errorMap"
require "teamf1lualib/returnCodes"
require "teamf1lualib/wan_configurablePort"

	PAGE_HELP = "network"
	if (UNIT_NAME == "DSR-1000N" or UNIT_NAME == "DSR-1000" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then 
        PAGE_HELP_SECTION = "wanMode_1000"
    elseif (UNIT_NAME=="DSR-500N" or UNIT_NAME=="DSR-500" or PRODUCT_ID == "DSR-500AC_Ax" or PRODUCT_ID == "DSR-500_Bx") then     
        PAGE_HELP_SECTION = "wanMode_500"
    else
        PAGE_HELP_SECTION = "wanMode_econa"
        end
	
local wan_multiwan  = require("com.teamf1.bl.wan.multiwan")
local errorMap    = require ("com.teamf1.core.errorMap")
local returnCodes = require ("com.teamf1.core.returnCodes")
local wan_configurablePort = require("com.teamf1.core.wan.configurableport")

local errorCode = wan_multiwan.optionModeSectionPortCheck()
if (errorCode ~= returnCodes.SUCCESS) then
    statusInfoMessage = errorMap.errorStringGet (errorCode)
end

if (ButtonType and ButtonType == "config") then
    local inputTable = web.cgiToLuaTable(cgi)
    local rowId = "1"
    local disableFlag
    if (disableFlag ~= "1") then
        inputTable["optionMode.cookie"] = rowId
        local returnCode, cookie = wan_multiwan.optionModeSectionSet(inputTable)
        if (returnCode == returnCodes.SUCCESS) then
            statusSuccessMessage = errorMap.errorStringGet (returnCode)
        else 
            statusErrorMessage = errorMap.errorStringGet (returnCode)
	    end
    end
   
    web.goToPage(NextPage, true, true)

else
    local returnCode, cookie, dmzPort = wan_configurablePort.configPortUsageGet ()

    local returnCode, cookie, primaryWanPort, failureDetectionMethod, 
           ipAddress, retryInterval, maxFailures, multiWanMode, wan1IpAddress, 
           wan2IpAddress, defaultWanPort, loadbalanceMode, loadTolerance, maxBandwidth, 
           secondaryWanPort, wan3IpAddress,Unit
                         = wan_multiwan.optionModeSectionGet()
    if (returnCode ~= returnCodes.SUCCESS) then
        statusErrorMessage = errorMap.errorStringGet (returnCode)
    end
    

    cgilua.header ("Content-Type","text/html; charset=UTF-8")
    LANG_LOCALE = "13307,13308,10339,11588,12863,11589,12724,12911,13303,30137,10799,11943,13301,12698,11337,12732,10999,10996,11261,12910,11590,11293,11686,30138,11488,13657,14082,13228,13229,13225,11998,11999,11200,12077,12078,12079,12044,30017,30018,30139,30140,11789,30015,10683,12627,12758,10449,50048,50054,50213"
?>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Language" content="en-us">
        <title>$|COMPANY_NAME|$ : $|APP_NAME|$</title>
<!--
Copyright (c) 2012 - 2013 TeamF1, Inc. (www.TeamF1.com)
All rights reserved.
-->
        <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" type="text/css" href="css/buttons.css" />
        <link rel="stylesheet" type="text/css" href="css/menu.css" />
        <script type="text/javascript" language="javascript" src="js/jquery-1.8.0.min.js"></script>
        <?lua web.includeMenu("metaInclude.html")?>
    </head>
    <body>
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td class="header" valign="top" align="center">
                <?lua web.includeMenu("header.html")?></td>
            </tr>
            <tr>
                <td valign="top" align="center">
                <div class="midWidth">
                    <script language="JavaScript">
                        mmSel("mainMenu3");
                    </script>
                    <!-- Status message place holder... [ 1. for error use "msgError" 2. for information use "msgInfo" 3. for sucess use "msgSuccess" CSS classes ]-->
                    <?lua if (statusInfoMessage ~= returnCodes.NIL) then
                        if (statusErrorMessage == returnCodes.NIL) then
                    ?>

                    <div class="msgInfo">
                    <p>$| statusInfoMessage |$</p>
                    </div>
                    <?lua else
                    ?>
                    <div class="msgError">
                    <p>$| statusErrorMessage |$</p>
                    </div>
                    <?lua end ?>
                    <?lua 
                    elseif (statusErrorMessage ~= returnCodes.NIL) then
                    ?>    
                    <div class="msgError">
                    <p>$| statusErrorMessage |$</p>
                </div>
                <?lua elseif (statusSuccessMessage ~= returnCodes.NIL) then
                ?>
                <div class="msgSuccess">
                    <p>$| statusSuccessMessage |$</p>
                </div>
                    <?lua end ?>
                    <div class="FL2">
                        <p class="hint">
                                    $| helpHintText |$ 
                        </p>
                    </div>
                    <h1>$| LANG_LOCALE['13307'] |$</h1>
                    <div class="midArea">
                        <div align="left">
                            <form name="tf1_frmOptionMode" id="tf1_frmOptionMode" method="post" action="platform.cgi">
                            <input type="hidden" name="thispage" id="thispage" value="wanMode.html">
                                <h2>$| LANG_LOCALE['13308'] |$</h2>
                                <!--div class="break">
                                    &nbsp;
                                </div-->
                                <div class="configRow">
                                    <label>$| LANG_LOCALE['13307'] |$</label>
                                    <select name="optionMode.multiWanMode" id="tf1_optionMode" onchange="changeOptionMode('tf1_optionMode')">
                                        <?lua if(UNIT_NAME =="DSR-500N" or UNIT_NAME=="DSR-500" or PRODUCT_ID == "DSR-500AC_Ax" or PRODUCT_ID == "DSR-500_Bx") then 
                                            if (dmzPort ~= 'DMZ') then ?>
                                                <option $| web.dropdownSelected(multiWanMode == "1") |$ value="1">$| LANG_LOCALE['10339'] |$</option> 
                                            <?lua end else ?> 
                                            <option $| web.dropdownSelected(multiWanMode == "1") |$ value="1">$| LANG_LOCALE['10339'] |$</option>
                                       <?lua end ?>

                                        <option $| web.dropdownSelected(multiWanMode == "2") |$ value="2">$| LANG_LOCALE['11588'] |$</option>
                                        <option $| web.dropdownSelected(multiWanMode == "3") |$ value="3">$| LANG_LOCALE['12863'] |$</option>
                                    </select>
                                </div>
                                <div class="break">
                                    &nbsp;
                                </div>
                                <!-- Load balancing setup -->
                                <div id="tf1_loadBalancing_div">
                                    <h2>$| LANG_LOCALE['11589'] |$</h2>
                                    <div class="configRow">
                                        <label>$| LANG_LOCALE['11588'] |$</label>
                                        <p>
                                            <?lua 
                                                if (loadbalanceMode == nil) then
                                                    loadbalanceMode = "1"
                                                end
                                            ?>
                                            <input type="radio" $| web.radioSelected(loadbalanceMode == "1") |$ value="1" name="optionMode.loadbalanceMode" id="tf1_loadingBalSetup" onclick="changeLoadBalancing('tf1_loadingBalSetup')">
                                            $| LANG_LOCALE['12724'] |$
                                        </p>
                                        <p>
                                            <input type="radio" $| web.radioSelected(loadbalanceMode == "2") |$ value="2" name="optionMode.loadbalanceMode" id="tf1_loadingBalSetup" onclick="changeLoadBalancing('tf1_loadingBalSetup')">
                                            $| LANG_LOCALE['12911'] |$
                                        </p>
                                    </div>
                                    <div class="break" id="break_loadingBalSetup_div">
                                        &nbsp;
                                    </div>
				    <div class="configRow" id="tf1_dnsoption_div">
					<label>$| LANG_LOCALE['13303'] |$</label>
					<select id="tf1_dnsoption" name="optionMode.loadBalance_failureDetectionMethod" onChange="lookLoadDnsOptions('tf1_dnsoption');">
					    <option $| web.dropdownSelected(failureDetectionMethod == "1") |$ value="1">$| LANG_LOCALE['11789'] |$</option>
					    <option $| web.dropdownSelected(failureDetectionMethod == "2") |$ value="2">$| LANG_LOCALE['30137'] |$</option>
					    <option $| web.dropdownSelected(failureDetectionMethod == "3") |$ value="3">$| LANG_LOCALE['10799'] |$</option>
					    <option $| web.dropdownSelected(failureDetectionMethod == "4") |$ value="4">$| LANG_LOCALE['11943'] |$</option>
					</select>
				    </div>
				    <div class="break" id="break_dnsoption_div">
					&nbsp;
				    </div>
                                    <div class="configRow" id="tf1_loadOption1_div">
                                        <label> $| LANG_LOCALE['30015'] |$ </label>
                                        <input type="text" name="optionMode.loadBalance_dns_wan1IpAddress" value="$|wan1IpAddress or ''|$" id="tf1_loadOption1" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_loadOption1_div">
                                        &nbsp;
                                    </div>
                                    <div class="configRow" id="tf1_loadOption2_div">
                                        <label> $| LANG_LOCALE['30017'] |$ </label>
                                        <input type="text" name="optionMode.loadBalance_dns_wan2IpAddress" value="$|wan2IpAddress or ''|$" id="tf1_loadOption2" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_loadOption2_div">
                                        &nbsp;
                                    </div>
                                    <?lua if(UNIT_NAME == "DSR-1000" or UNIT_NAME == "DSR-1000N" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then?>
				    <div class="configRow" id="tf1_loadOption3_div">
					<label> $| LANG_LOCALE['30018'] |$ </label>
					<input type="text" name="optionMode.loadBalance_dns_wan3IpAddress" value="$|wan3IpAddress or ''|$" id="tf1_loadOption3" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, 'Invalid IP address', 'for octet ', true); }">
				    </div>
				    <div class="break" id="break_loadOption3_div">
					&nbsp;
				    </div>
                                    <?lua end?>
                                    <div class="configRow" id="tf1_loadPingOption1_div">
                                        <label>$| LANG_LOCALE['30015'] |$</label>
                                        <input type="text" name="optionMode.loadBalance_ping_wan1IpAddress" value="$|wan1IpAddress or ''|$" id="tf1_loadPingOption1" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_loadPingOption1_div">
                                        &nbsp;
                                    </div>
                                    <div class="configRow" id="tf1_loadPingOption2_div">
                                        <label>$| LANG_LOCALE['30017'] |$</label>
                                        <input type="text" name="optionMode.loadBalance_ping_wan2IpAddress" value="$|wan2IpAddress or ''|$" id="tf1_loadPingOption2" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_loadPingOption2_div">
                                        &nbsp;
                                    </div>
                                    <?lua if(UNIT_NAME == "DSR-1000" or UNIT_NAME == "DSR-1000N" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then?>
				    <div class="configRow" id="tf1_loadPingOption3_div">
					<label>$| LANG_LOCALE['30018'] |$</label>
					<input type="text" name="optionMode.loadBalance_ping_wan3IpAddress" value="$|wan3IpAddress or ''|$" id="tf1_loadPingOption3" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
				    </div>
				    <div class="break" id="break_loadPingOption3_div">
					&nbsp;
				    </div>
                                    <?lua end?>
                                    <div class="configRow" id="tf1_loadRetryInterval_div">
                                        <label>$| LANG_LOCALE['12698'] |$</label>
                                        <input class="one" type="text" name="optionMode.loadBalance_retryInterval" value="$|retryInterval or ''|$" maxlength="3" id="tf1_loadRetryInterval" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return numericValueRangeCheck (this, '', '', 5, 999, true, LANG_LOCALE['11337']+'. ', '');}">
                                        <dl>
                                            [$| LANG_LOCALE['10683'] |$: 30,  $| LANG_LOCALE['12627'] |$: 5 - 999] $| LANG_LOCALE['12732'] |$
                                        </dl>
                                    </div>
                                    <div class="break" id="break_loadRetryInterval_div">
                                        &nbsp;
                                    </div>
                                    <div class="configRow" id="tf1_loadFailOverAfter_div">
                                        <label>$| LANG_LOCALE['10996'] |$</label>
                                        <input class="one" type="text" name="optionMode.loadBalance_maxFailures" value="$|maxFailures or ''|$" maxlength="3" id="tf1_loadFailOverAfter" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return numericValueRangeCheck (this, '', '', 2, 999, true, LANG_LOCALE['11261']+'. ', '');}">
                                        <dl>
                                            [$| LANG_LOCALE['10683'] |$: 4,  $| LANG_LOCALE['12627'] |$: 2 - 999] $| LANG_LOCALE['10999'] |$
                                        </dl>
                                    </div>
                                    <div class="break" id="break_loadFailOverAfter_div">
                                        &nbsp;
                                    </div>
                                    <div id="tf1_spilloverConfigSetupBlock_div">
                                        <h2>$| LANG_LOCALE['12910'] |$</h2>
                                        <div class="configRow" id="tf1_loadTolerance_div">
                                            <label>$| LANG_LOCALE['11590'] |$</label>
                                            <input class="one" type="text" name="optionMode.loadBalance_loadTolerance" value="$|loadTolerance or ''|$" maxlength="2" id="tf1_loadTolerance" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return numericValueRangeCheck (this, '', '', 20, 80, true, LANG_LOCALE['11293']+'. ', '');}">
                                            <dl>
                                                [$| LANG_LOCALE['10683'] |$: 80,  $| LANG_LOCALE['12627'] |$: 20 - 80] 
                                            </dl>
                                        </div>
                                        <div class="break" id="break_loadTolerance_div">
                                            &nbsp;
                                        </div>
                                        <div class="configRow" id="tf1_maxBandwidth_div">
                                            <label>$| LANG_LOCALE['11686'] |$</label>
                                            <input class="one" type="text" name="optionMode.loadBalance_maxBanwidth" value="$|maxBandwidth or ''|$" maxlength="4" id="tf1_maxBandwidth" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return unitNameChecks();}">
                                             <select size="1" name="optionMode.Unit" id="tf1_selMaxBandwidthUnit">
                      <option $| web.dropdownSelected(Unit == "0") |$ value="0">$| LANG_LOCALE['30138'] |$</option>
                      <option $| web.dropdownSelected(Unit == "1") |$ value="1">$| LANG_LOCALE['11488'] |$</option>
                      <option $| web.dropdownSelected(Unit == "2") |$ value="2">$| LANG_LOCALE['13657'] |$</option>
                      </select><dl>($| LANG_LOCALE['14082'] |$. 100 $| LANG_LOCALE['13657'] |$)</dl>                                           
                                        </div>
                                        <div class="break" id="break_maxBandwidth_div">
                                            &nbsp;
                                        </div>

                                    </div>
                                </div>
                                <!-- Load balancing ends --><!--Auto-Rollover using WAN port Starts here -->
                                <div id="tf1_autoRollOver_div">
                                    <h2>$| LANG_LOCALE['10339'] |$</h2>
                                    <div class="configRow" id="tf1_rolloveroption_div">
                                        <label>$| LANG_LOCALE['13228'] |$</label>
                                        <p>
                                            <input type="radio" value="1" $| web.radioSelected(primaryWanPort == "1") |$ name="optionMode.autoRollover_primaryWanPort"  id="tf1_rolloveroption1" onClick="lookRollDnsOptions ('tf1_rolloveroption1');">
                                            $| LANG_LOCALE['30015'] |$
                                        </p>
                                        <?lua if (dmzPort ~= 'DMZ') then ?>
                                        <p>
                                            <input type="radio" value="2" $| web.radioSelected(primaryWanPort == "2") |$ name="optionMode.autoRollover_primaryWanPort" id="tf1_rolloveroption2" onClick="lookRollDnsOptions ('tf1_rolloveroption2');">
                                            $| LANG_LOCALE['30017'] |$
                                        </p>
                                        <?lua end ?>
                                        <?lua if(UNIT_NAME == "DSR-1000" or UNIT_NAME == "DSR-1000N" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then?>
                                        <p>
                                            <input type="radio" value="3" $| web.radioSelected(primaryWanPort == "3") |$ name="optionMode.autoRollover_primaryWanPort" id="tf1_rolloveroption3" onClick="lookRollDnsOptions ('tf1_rolloveroption3');">
                                            $| LANG_LOCALE['30018'] |$
                                            </p>
                                            <?lua end ?>
                                    </div>
                                    <div class="break" id="break_rolloveroption_div">
                                        &nbsp;
                                    </div>
				    <div class="configRow" id="tf1_rolloverSecondaryWAN_div">
					<label>$| LANG_LOCALE['13229'] |$</label>
					<select id="tf1_rolloverSecondaryWAN" name="optionMode.autoRollover_secondaryWanPort" size="1">			 					
					</select>
				    </div>
				    <div class="break" id="break_rolloverSecondaryWAN_div">
					&nbsp;
				    </div>
				    <div class="configRow" id="tf1_rolldnsoption_div">
				        <label>$| LANG_LOCALE['13303'] |$</label>
                                            <?lua
                                                if (failureDetectionMethod == nil or failureDetectionMethod == "1") then
                                                    failureDetectionMethod = "2"
                                                end

						    wan1DispName = LANG_LOCALE['30015']
                                            ?>
					<select name="optionMode.autoRollover_failureDetectionMethod" id="tf1_rolldnsoption" onChange="selRollWanCheck();">
					    <option $| web.dropdownSelected(failureDetectionMethod == "2") |$ value="2">$| LANG_LOCALE['30137'] |$</option>
					    <option $| web.dropdownSelected(failureDetectionMethod == "3") |$ value="3">$| LANG_LOCALE['10799'] |$</option>
					    <option $| web.dropdownSelected(failureDetectionMethod == "4") |$ value="4">$| LANG_LOCALE['11943'] |$</option>
					</select>
				    </div>
				    <div class="break" id="break_rolldnsoption_div">
					&nbsp;
				    </div>
                                    <div class="configRow" id="tf1_AutoDnsOption1_div">
                                        <label> $|wan1DispName|$ </label>
                                        <input type="text" name="optionMode.autoRollover_dns_ipAddress1" value="$|ipAddress or ''|$" id="tf1_AutoDnsOption1" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_AutoDnsOption1_div">
                                        &nbsp;
                                    </div>
                                    <div class="configRow" id="tf1_AutoDnsOption2_div">
                                        <label>$| LANG_LOCALE['30017'] |$</label>
                                        <input type="text" name="optionMode.autoRollover_dns_ipAddress2" value="$|ipAddress or ''|$" id="tf1_AutoDnsOption2" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_AutoDnsOption2_div">
                                        &nbsp;
                                    </div>
                                    <?lua if(UNIT_NAME == "DSR-1000" or UNIT_NAME == "DSR-1000N" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then?>
				    <div class="configRow" id="tf1_AutoDnsOption3_div">
				        <label>$| LANG_LOCALE['30018'] |$</label>
					<input type="text" name="optionMode.autoRollover_dns_ipAddress3" value="$|ipAddress or ''|$" id="tf1_AutoDnsOption3" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
				    </div>
				    <div class="break" id="break_AutoDnsOption3_div">
					&nbsp;
				    </div>
                                    <?lua end?>
                                    <div class="configRow" id="tf1_AutoPingOption1_div">
                                        <label> $|wan1DispName|$ </label>
                                        <input type="text" name="optionMode.autoRollover_ping_ipAddress1" value="$|ipAddress or ''|$" id="tf1_AutoPingOption1" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_AutoPingOption1_div">
                                        &nbsp;
                                    </div>
                                    <div class="configRow" id="tf1_AutoPingOption2_div">
                                        <label>$| LANG_LOCALE['30017'] |$</label>
                                        <input type="text" name="optionMode.autoRollover_ping_ipAddress2" value="$|ipAddress or ''|$" id="tf1_AutoPingOption2" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
                                    </div>
                                    <div class="break" id="break_AutoPingOption2_div">
                                        &nbsp;
                                    </div>
                                    <?lua if(UNIT_NAME == "DSR-1000" or UNIT_NAME == "DSR-1000N" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then?>
				    <div class="configRow" id="tf1_AutoPingOption3_div">
					<label>$| LANG_LOCALE['30018'] |$</label>
					<input type="text" name="optionMode.autoRollover_ping_ipAddress3" value="$|ipAddress or ''|$" id="tf1_AutoPingOption3" maxlength="15" onKeyPress="return numericValueCheck (event, '.')" onKeyDown="if (event.keyCode == 9) { return ipv4AddrValidate (this, 'IP', false, true, LANG_LOCALE['11281'], LANG_LOCALE['11031'], true); }">
				    </div>
				    <div class="break" id="break_AutoPingOption3_div">
					&nbsp;
				    </div>
                                    <?lua end?>
                                    <div class="configRow" id="tf1_AutoRetryInterval_div">
                                        <label>$| LANG_LOCALE['12698'] |$</label>
                                        <input class="one" type="text" name="optionMode.autoRollover_retryInterval" value="$|retryInterval or ''|$" maxlength="3" id="tf1_AutoRetryInterval" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return numericValueRangeCheck (this, '', '', 5, 999, true, LANG_LOCALE['11337']+'. ', '');}">
                                        <dl>
                                            [$| LANG_LOCALE['10683'] |$: 30,  $| LANG_LOCALE['12627'] |$: 5 - 999] $| LANG_LOCALE['12732'] |$
                                        </dl>
                                    </div>
                                    <div class="break" id="break_AutoRetryInterval_div">
                                        &nbsp;
                                    </div>
                                    <div class="configRow" id="tf1_AutoFailoverAfter_div">
                                        <label>$| LANG_LOCALE['10996'] |$</label>
                                        <input class="one" type="text" name="optionMode.autoRollover_maxFailures" value="$|maxFailures or ''|$" maxlength="3" id="tf1_AutoFailoverAfter" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return numericValueRangeCheck (this, '', '', 2, 999, true, LANG_LOCALE['11261']+'. ', '');}">
                                        <dl>
                                            [$| LANG_LOCALE['10683'] |$: 4, $| LANG_LOCALE['12627'] |$: 2 - 999] $| LANG_LOCALE['10999'] |$
                                        </dl>
                                    </div>
                                    <div class="break" id="break_AutoFailoverAfter_div">
                                        &nbsp;
                                    </div>
                                </div>
                                <!--Auto-Rollover using WAN port Ends here --><!-- Single WAN port Starts here -->
                                <div id="tf1_singleOption_div">
                                    <h2>$| LANG_LOCALE['12863'] |$</h2>
                                    <div class="configRow">
                                        <label>$| LANG_LOCALE['13225'] |$</label>
                                        <p>
                                            <input type="radio" $| web.radioSelected(defaultWanPort == "1") |$ name="optionMode.defaultWanPort" value="1" name="channe2">
                                            $| LANG_LOCALE['30015'] |$
                                        </p>
                                        <?lua if (dmzPort ~= 'DMZ') then ?>
                                        <p>
                                            <input type="radio" $| web.radioSelected(defaultWanPort == "2") |$ name="optionMode.defaultWanPort" value="2" name="channe2">
                                            $| LANG_LOCALE['30017'] |$
                                        </p>
                                        <?lua end ?>
                                        <?lua if(UNIT_NAME == "DSR-1000" or UNIT_NAME == "DSR-1000N" or PRODUCT_ID == "DSR-1000AC_Ax" or PRODUCT_ID == "DSR-1000_Bx") then?>
                                        <p>
                                            <input type="radio" $| web.radioSelected(defaultWanPort == "3") |$ name="optionMode.defaultWanPort" value="3" name="channe2">
                                            $| LANG_LOCALE['30018'] |$
                                        </p>
                                        <?lua end?>
                                    </div>
                                    <div class="break">
                                        &nbsp;
                                    </div>
                                </div>
                                <!--Single WAN port Ends here -->
                                <div class="submitRow">
                                    <input type="submit" name="button.config.wanMode" onclick="setHiddenChks('tf1_frmOptionMode'); return modeValidate ()" class="btnSubmit" title="$| LANG_LOCALE['12758'] |$" value="$| LANG_LOCALE['12758'] |$" id="btSave">
                                    <input type="button" class="btnReset" title="$| LANG_LOCALE['10449'] |$" value="$| LANG_LOCALE['10449'] |$" id="btSave" onclick="this.form.reset(); resetImgOnOff('tf1_frmOptionMode'); changeOptionMode('tf1_optionMode');">
                                </div>
                                <div class="break">
                                    &nbsp;
                                </div>
                            </form>
                        </div>
                    </div>
                </div></td>
            </tr>
            <tr>
                <td>
                <?lua web.includeMenu("footer.html")?></td>
            </tr>
        </table>
	    <input type="hidden" id="hdFailOver" value="$| secondaryWanPort or ''|$">
	    <input type="hidden" id="hdUnitName" value="$| UNIT_NAME or ''|$">
	    <input type="hidden" id="hdProductID" value="$| PRODUCT_ID or ''|$">
	    <input type="hidden" id="hddmzPort" value="$| dmzPort |$">
        <input type="hidden" id="hdloadbalanceMode" value="$| loadbalanceMode or '' |$">
        <script type="text/javascript" language="javascript" src="js/mis.js"></script>
        <script type="text/javascript" language="javascript" src="js/textValidations.js"></script>
        <script type="text/javascript" language="javascript" src="js/mgmt.js"></script>
        <script type="text/javascript" language="javascript" src="js/ipv4AddrValidations.js"></script>
        <script type="text/javascript" language="javascript" src="js/o
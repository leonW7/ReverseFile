<?lua
require "teamf1lualib/inbox_bl"
require "teamf1lualib/errorMap"
require "teamf1lualib/returnCodes"

local errorMap    = require ("com.teamf1.core.errorMap")
local returnCodes = require ("com.teamf1.core.returnCodes")

if(ButtonType == "reply" or ButtonType == "forward") then
        local returnCode, createMessageTable
        configRowId = cgi["configRowId"]
        returnCode,createMessageTable = inboxGetIdTbl (configRowId)
        if (returnCode == returnCodes.SUCCESS) then
            if (ButtonType == "reply") then
            	createMessageTable["Text"]= ""
            elseif (ButtonType == "forward") then
            	createMessageTable["Sender"] = ""
            end
            statusSuccessMessage = errorMap.errorStringGet (returnCode)
        else 
            statusErrorMessage = errorMap.errorStringGet (returnCode)
	end
cgilua.header ("Content-Type","text/html; charset=UTF-8")
?>
<div id="tf1_inboxDailogContent">
    <div class="topBg">
        <h1 data-localize="10617">Create SMS</h1>
                    <close>
                        <a href="#" id="btnClose" title="Close">X</a>
                    </close>
                </div>
    <div class="dialogMidArea">
        <div class="configRow">
            <label data-localize="12637">Receiver </label>
	    <?lua if (ButtonType == "forward") then ?>
            <input type="text" name="createSms.receiver" maxlength="12" value="$| createMessageTable["Sender"] or ''|$" id="tf1_receiver" onKeyPress="return numericValueCheck (event)" onKeyDown="if (event.keyCode == 9) {return numericValueRangeCheck (this, '', '', true, '', '');}">
	    <?lua else ?>
	    <p>$| createMessageTable["Sender"] or ''|$</p>
	    <input type="hidden" name="createSms.receiver" value="$| createMessageTable["Sender"] or ''|$" />
	    <?lua end ?>
        </div>
        <div class="break">
&nbsp; </div>
        <div class="configRow">
            <label data-localize="13058">Text Message </label>
            <textarea id="tf1_textMessage" name="createSms.text">$| createMessageTable["Text"] or ''|$</textarea>
        </div>
        <div class="break">
&nbsp; </div>
    </div>
    <div class="dialogSubmitRow">
	<input data-localize="12814" type="submit" name="button.config.inbox.inbox.$| configRowId |$" onclick="return createSmsValidations()" class="btnSubmit" title="Send Message" value="Send Message" id="btSave">
    </div>
    </div>
</div>
<?lua end ?>
